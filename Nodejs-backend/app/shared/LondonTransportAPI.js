"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const request = require("request-promise");
const logger_1 = require("./logger");
class LondonTransportAPI {
    constructor() {
        this.defaultURL = "https://api.tfl.gov.uk/";
        this.appID = "64cafb9b";
        this.key = "1824212fb2a19279eb460255ba35966c";
    }
    getBusLineStations(lineID) {
        return new Promise((resolve, reject) => {
            let url = this.defaultURL + "line/" + lineID + "/StopPoints/";
            let opts = {
                uri: url,
                method: 'GET',
                qs: {
                    app_id: this.appID,
                    app_key: this.key
                }
            };
            request(opts).then((result) => {
                //console.log("Got response from London Transport API: " + result);
                if (result) {
                    let data = JSON.parse(result);
                    if (data.length > 0) {
                        let stationsData = [];
                        for (let station of data) {
                            stationsData.push({
                                id: station.id,
                                name: station.commonName
                            });
                        }
                        resolve(stationsData);
                    }
                }
                else {
                    logger_1.Logger.log("Can not get bus line stations info from API");
                    reject("Can not get bus line stations info from API");
                }
            }).catch(err => {
                logger_1.Logger.log("London Transport API error: ", err);
                reject(err);
            });
        });
    }
    getStationTimeTable(lineID, stationID) {
        return new Promise((resolve, reject) => {
            let url = this.defaultURL + "line/" + lineID + "/Timetable/" + stationID;
            let opts = {
                uri: url,
                method: 'GET',
                qs: {
                    app_id: this.appID,
                    app_key: this.key
                }
            };
            request(opts).then((result) => {
                //console.log("Got time table response from London Transport API: " + result);
                if (result) {
                    let data = JSON.parse(result);
                    //console.log("Got time table response from London Transport API: ", data);
                    if (data.timetable && data.timetable.routes && data.timetable.routes.length === 1) {
                        if (data.timetable.routes[0].schedules && data.timetable.routes[0].schedules.length > 0) {
                            let timeTableData = [];
                            for (let schedule of data.timetable.routes[0].schedules) {
                                let lastHour = (Number(schedule.lastJourney.hour) % 24) + "";
                                let busSchedule = {
                                    date: schedule.name,
                                    first: schedule.firstJourney.hour + ":" + schedule.firstJourney.minute,
                                    last: lastHour + ":" + schedule.lastJourney.minute
                                };
                                timeTableData.push(busSchedule);
                            } //for
                            resolve(timeTableData);
                        }
                        else {
                            logger_1.Logger.log("Bus line stations time table data error");
                            reject("Bus line stations time table data error");
                        }
                    }
                    else {
                        logger_1.Logger.log("Bus line stations time table data error");
                        reject("Bus line stations time table data error");
                    }
                }
                else {
                    logger_1.Logger.log("Can not get bus line stations time table info from API");
                    reject("Can not get bus line stations time table info from API");
                }
            }).catch(err => {
                logger_1.Logger.log("London Transport API error: ", err);
                reject(err);
            });
        });
    }
}
exports.LondonTransportAPI = LondonTransportAPI;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTG9uZG9uVHJhbnNwb3J0QVBJLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiTG9uZG9uVHJhbnNwb3J0QVBJLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsMkNBQTRDO0FBQzVDLHFDQUFrQztBQVlsQyxNQUFhLGtCQUFrQjtJQUEvQjtRQUVJLGVBQVUsR0FBVyx5QkFBeUIsQ0FBQztRQUUvQyxVQUFLLEdBQVcsVUFBVSxDQUFDO1FBQzNCLFFBQUcsR0FBVyxrQ0FBa0MsQ0FBQztJQThGckQsQ0FBQztJQTVGVSxrQkFBa0IsQ0FBQyxNQUFjO1FBRXBDLE9BQU8sSUFBSSxPQUFPLENBQUMsQ0FBQyxPQUFPLEVBQUUsTUFBTSxFQUFFLEVBQUU7WUFFbkMsSUFBSSxHQUFHLEdBQUcsSUFBSSxDQUFDLFVBQVUsR0FBRyxPQUFPLEdBQUcsTUFBTSxHQUFHLGNBQWMsQ0FBQztZQUU5RCxJQUFJLElBQUksR0FBb0I7Z0JBQ3hCLEdBQUcsRUFBRSxHQUFHO2dCQUNSLE1BQU0sRUFBRSxLQUFLO2dCQUNiLEVBQUUsRUFBRTtvQkFDQSxNQUFNLEVBQUUsSUFBSSxDQUFDLEtBQUs7b0JBQ2xCLE9BQU8sRUFBRSxJQUFJLENBQUMsR0FBRztpQkFDcEI7YUFDSixDQUFBO1lBRUQsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLE1BQU0sRUFBRSxFQUFFO2dCQUMxQixtRUFBbUU7Z0JBQ25FLElBQUksTUFBTSxFQUFFO29CQUNSLElBQUksSUFBSSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUM7b0JBQzlCLElBQUcsSUFBSSxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUM7d0JBQ2YsSUFBSSxZQUFZLEdBQW9CLEVBQUUsQ0FBQzt3QkFDdkMsS0FBSSxJQUFJLE9BQU8sSUFBSSxJQUFJLEVBQUM7NEJBQ3BCLFlBQVksQ0FBQyxJQUFJLENBQUM7Z0NBQ2QsRUFBRSxFQUFFLE9BQU8sQ0FBQyxFQUFFO2dDQUNk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QyxDQUFDLENBQUM7cUJBQ3JEO2lCQUNKO3FCQUFJO29CQUNELGVBQU0sQ0FBQyxHQUFHLENBQUMsd0RBQXdELENBQUMsQ0FBQztvQkFDckUsTUFBTSxDQUFDLHdEQUF3RCxDQUFDLENBQUM7aUJBQ3BFO1lBQ0wsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxFQUFFO2dCQUNYLGVBQU0sQ0FBQyxHQUFHLENBQUMsOEJBQThCLEVBQUUsR0FBRyxDQUFDLENBQUM7Z0JBQ2hELE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUNoQixDQUFDLENBQUMsQ0FBQTtRQUNOLENBQUMsQ0FBQyxDQUFBO0lBQ04sQ0FBQztDQUNKO0FBbkdELGdEQW1HQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCByZXF1ZXN0ID0gcmVxdWlyZSgncmVxdWVzdC1wcm9taXNlJyk7XG5pbXBvcnQgeyBMb2dnZXIgfSBmcm9tICcuL2xvZ2dlcic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3RhdGlvbntcbiAgICBpZD86IHN0cmluZztcbiAgICBuYW1lPzogc3RyaW5nO1xuICB9XG5leHBvcnQgaW50ZXJmYWNlIFNjaGVkdWxle1xuICAgIGRhdGU/OiBzdHJpbmc7XG4gICAgZmlyc3Q/OiBzdHJpbmc7XG4gICAgbGFzdD86IHN0cmluZztcbiAgfVxuXG5leHBvcnQgY2xhc3MgTG9uZG9uVHJhbnNwb3J0QVBJIHtcblxuICAgIGRlZmF1bHRVUkw6IHN0cmluZyA9IFwiaHR0cHM6Ly9hcGkudGZsLmdvdi51ay9cIjtcblxuICAgIGFwcElEOiBzdHJpbmcgPSBcIjY0Y2FmYjliXCI7XG4gICAga2V5OiBzdHJpbmcgPSBcIjE4MjQyMTJmYjJhMTkyNzllYjQ2MDI1NWJhMzU5NjZjXCI7XG5cbiAgICBwdWJsaWMgZ2V0QnVzTGluZVN0YXRpb25zKGxpbmVJRDogc3RyaW5nKTogUHJvbWlzZTxhbnk+IHtcblxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXG4gICAgICAgICAgICBsZXQgdXJsID0gdGhpcy5kZWZhdWx0VVJMICsgXCJsaW5lL1wiICsgbGluZUlEICsgXCIvU3RvcFBvaW50cy9cIjtcblxuICAgICAgICAgICAgbGV0IG9wdHM6IHJlcXVlc3QuT3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICB1cmk6IHVybCxcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgICAgIHFzOiB7XG4gICAgICAgICAgICAgICAgICAgIGFwcF9pZDogdGhpcy5hcHBJRCxcbiAgICAgICAgICAgICAgICAgICAgYXBwX2tleTogdGhpcy5rZXlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJlcXVlc3Qob3B0cykudGhlbigocmVzdWx0KSA9PiB7XG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIkdvdCByZXNwb25zZSBmcm9tIExvbmRvbiBUcmFuc3BvcnQgQVBJOiBcIiArIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBsZXQgZGF0YSA9IEpTT04ucGFyc2UocmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgaWYoZGF0YS5sZW5ndGggPiAwKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzdGF0aW9uc0RhdGEgOiBBcnJheTxTdGF0aW9uPiA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGxldCBzdGF0aW9uIG9mIGRhdGEpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRpb25zRGF0YS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHN0YXRpb24uaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHN0YXRpb24uY29tbW9uTmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN0YXRpb25zRGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgTG9nZ2VyLmxvZyhcIkNhbiBub3QgZ2V0IGJ1cyBsaW5lIHN0YXRpb25zIGluZm8gZnJvbSBBUElcIik7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChcIkNhbiBub3QgZ2V0IGJ1cyBsaW5lIHN0YXRpb25zIGluZm8gZnJvbSBBUElcIik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KS5jYXRjaChlcnIgPT4ge1xuICAgICAgICAgICAgICAgIExvZ2dlci5sb2coXCJMb25kb24gVHJhbnNwb3J0IEFQSSBlcnJvcjogXCIsIGVycik7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIHB1YmxpYyBnZXRTdGF0aW9uVGltZVRhYmxlKGxpbmVJRDogc3RyaW5nLCBzdGF0aW9uSUQ6IHN0cmluZyk6IFByb21pc2U8YW55PiB7XG5cbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcblxuICAgICAgICAgICAgbGV0IHVybCA9IHRoaXMuZGVmYXVsdFVSTCArIFwibGluZS9cIiArIGxpbmVJRCArIFwiL1RpbWV0YWJsZS9cIiArIHN0YXRpb25JRDtcblxuICAgICAgICAgICAgbGV0IG9wdHM6IHJlcXVlc3QuT3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICB1cmk6IHVybCxcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgICAgIHFzOiB7XG4gICAgICAgICAgICAgICAgICAgIGFwcF9pZDogdGhpcy5hcHBJRCxcbiAgICAgICAgICAgICAgICAgICAgYXBwX2tleTogdGhpcy5rZXlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJlcXVlc3Qob3B0cykudGhlbigocmVzdWx0KSA9PiB7XG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIkdvdCB0aW1lIHRhYmxlIHJlc3BvbnNlIGZyb20gTG9uZG9uIFRyYW5zcG9ydCBBUEk6IFwiICsgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBkYXRhID0gSlNPTi5wYXJzZShyZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwiR290IHRpbWUgdGFibGUgcmVzcG9uc2UgZnJvbSBMb25kb24gVHJhbnNwb3J0IEFQSTogXCIsIGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICBpZihkYXRhLnRpbWV0YWJsZSAmJiBkYXRhLnRpbWV0YWJsZS5yb3V0ZXMgJiYgZGF0YS50aW1ldGFibGUucm91dGVzLmxlbmd0aCA9PT0gMSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZihkYXRhLnRpbWV0YWJsZS5yb3V0ZXNbMF0uc2NoZWR1bGVzICYmIGRhdGEudGltZXRhYmxlLnJvdXRlc1swXS5zY2hlZHVsZXMubGVuZ3RoID4gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHRpbWVUYWJsZURhdGEgOiBBcnJheTxTY2hlZHVsZT4gPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IobGV0IHNjaGVkdWxlIG9mIGRhdGEudGltZXRhYmxlLnJvdXRlc1swXS5zY2hlZHVsZXMpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbGFzdEhvdXIgPSAoTnVtYmVyKHNjaGVkdWxlLmxhc3RKb3VybmV5LmhvdXIpICUgMjQpICsgXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGJ1c1NjaGVkdWxlOiBTY2hlZHVsZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IHNjaGVkdWxlLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJzdDpzY2hlZHVsZS5maXJzdEpvdXJuZXkuaG91ciArIFwiOlwiICsgc2NoZWR1bGUuZmlyc3RKb3VybmV5Lm1pbnV0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3Q6IGxhc3RIb3VyICsgXCI6XCIgKyBzY2hlZHVsZS5sYXN0Sm91cm5leS5taW51dGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1lVGFibGVEYXRhLnB1c2goYnVzU2NoZWR1bGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0vL2ZvclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUodGltZVRhYmxlRGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBMb2dnZXIubG9nKFwiQnVzIGxpbmUgc3RhdGlvbnMgdGltZSB0YWJsZSBkYXRhIGVycm9yXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChcIkJ1cyBsaW5lIHN0YXRpb25zIHRpbWUgdGFibGUgZGF0YSBlcnJvclwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICBMb2dnZXIubG9nKFwiQnVzIGxpbmUgc3RhdGlvbnMgdGltZSB0YWJsZSBkYXRhIGVycm9yXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiQnVzIGxpbmUgc3RhdGlvbnMgdGltZSB0YWJsZSBkYXRhIGVycm9yXCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgICAgIExvZ2dlci5sb2coXCJDYW4gbm90IGdldCBidXMgbGluZSBzdGF0aW9ucyB0aW1lIHRhYmxlIGluZm8gZnJvbSBBUElcIik7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChcIkNhbiBub3QgZ2V0IGJ1cyBsaW5lIHN0YXRpb25zIHRpbWUgdGFibGUgaW5mbyBmcm9tIEFQSVwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KS5jYXRjaChlcnIgPT4ge1xuICAgICAgICAgICAgICAgIExvZ2dlci5sb2coXCJMb25kb24gVHJhbnNwb3J0IEFQSSBlcnJvcjogXCIsIGVycik7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH1cbn0iXX0=